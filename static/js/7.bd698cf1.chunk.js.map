{"version":3,"sources":["../../../node_modules/@gmod/indexedfasta/dist/index.js","../../../node_modules/@gmod/indexedfasta/dist/localFile.js","../../../node_modules/@gmod/indexedfasta/dist/indexedFasta.js","../../../plugins/sequence/src/IndexedFastaAdapter/IndexedFastaAdapter.ts","../../../node_modules/@babel/runtime/helpers/toArray.js","../../../node_modules/browser-or-node/lib/index.js","../../../node_modules/@gmod/indexedfasta/dist/bgzipIndexedFasta.js"],"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","parseSmallFasta","enumerable","get","_bgzipIndexedFasta","default","_indexedFasta","FetchableSmallFasta","_regenerator","_asyncToGenerator2","_classCallCheck2","_createClass2","_toArray2","_localFile","text","split","filter","t","test","map","entryText","_entryText$split","_entryText$split2","defLine","seqLines","slice","_defLine$split","_defLine$split2","id","description","sequence","join","replace","_ref","fasta","path","this","data","readFile","then","buffer","toString","key","_fetch","mark","_callee","start","end","entry","length","wrap","_context","prev","next","sent","find","iter","Error","concat","abrupt","substr","stop","_x","_x2","_x3","apply","arguments","_getSequenceNames","_callee2","_context2","fsOpen","fsRead","fsFStat","fsReadFile","_typeof2","promisify","isNode","fs","open","read","fstat","LocalFile","source","position","filename","fd","_read","offset","ret","_args","undefined","t0","t1","t2","t3","t4","t5","bytesRead","_readFile","_stat","_callee3","_context3","module","_faiOffset","idx","pos","lineBytes","Math","floor","lineLength","IndexedFasta","fai","faiPath","_ref$chunkSizeLimit","chunkSizeLimit","_getIndexes2","indexes","_readFAI","_readFAI2","indexByName","indexById","idCounter","currSeq","line","forEach","row","name","_getIndexes","keys","call","_getSequenceSizes","_callee4","returnObject","vals","i","_context4","values","_getSequenceSize","_callee5","seqName","_context5","_hasReferenceSequence","_callee6","_context6","_getResiduesById","_callee7","seqId","min","max","indexEntry","_context7","_fetchFromIndexEntry","_x4","_x5","_getResiduesByName","_callee8","_context8","_x6","_x7","_x8","_getSequence","_callee9","_args9","_context9","getResiduesByName","_fetchFromIndexEntry2","_callee10","readlen","residues","_args10","_context10","TypeError","toLocaleString","Buffer","allocUnsafe","_x9","config","seqCache","AbortablePromiseCache","cache","LRU","maxSize","fill","args","a","refName","getSequence","fastaLocation","readConfObject","faiLocation","fastaOpts","openLocation","getSequenceNames","getSequenceSizes","seqSizes","ObservableCreate","observer","getSequenceSize","size","regionEnd","chunks","e","chunkSize","chunkStart","s","r","push","JSON","stringify","Promise","all","seq","SimpleFeature","complete","BaseFeatureDataAdapter","arrayWithHoles","iterableToArray","unsupportedIterableToArray","nonIterableRest","arr","__esModule","_typeof","Symbol","iterator","obj","constructor","prototype","isBrowser","window","document","isWebWorker","self","process","versions","node","isJsDom","navigator","userAgent","includes","_inherits2","_possibleConstructorReturn2","_getPrototypeOf2","_bgzfFilehandle","_createSuper","Derived","hasNativeReflectConstruct","Reflect","construct","sham","Proxy","Date","_isNativeReflectConstruct","result","Super","NewTarget","BgzipIndexedFasta","_IndexedFasta","_super","_this","gzi","gziPath","BgzfFilehandle","filehandle","gziFilehandle"],"mappings":"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","file":"static/js/7.bd698cf1.chunk.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.parseSmallFasta = parseSmallFasta;\nObject.defineProperty(exports, \"BgzipIndexedFasta\", {\n  enumerable: true,\n  get: function get() {\n    return _bgzipIndexedFasta.default;\n  }\n});\nObject.defineProperty(exports, \"IndexedFasta\", {\n  enumerable: true,\n  get: function get() {\n    return _indexedFasta.default;\n  }\n});\nexports.FetchableSmallFasta = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _toArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toArray\"));\n\nvar _localFile = _interopRequireDefault(require(\"./localFile\"));\n\nvar _bgzipIndexedFasta = _interopRequireDefault(require(\"./bgzipIndexedFasta\"));\n\nvar _indexedFasta = _interopRequireDefault(require(\"./indexedFasta\"));\n\nfunction parseSmallFasta(text) {\n  return text.split('>').filter(function (t) {\n    return /\\S/.test(t);\n  }).map(function (entryText) {\n    var _entryText$split = entryText.split('\\n'),\n        _entryText$split2 = (0, _toArray2.default)(_entryText$split),\n        defLine = _entryText$split2[0],\n        seqLines = _entryText$split2.slice(1);\n\n    var _defLine$split = defLine.split(' '),\n        _defLine$split2 = (0, _toArray2.default)(_defLine$split),\n        id = _defLine$split2[0],\n        description = _defLine$split2.slice(1);\n\n    var sequence = seqLines.join('').replace(/\\s/g, '');\n    return {\n      id: id,\n      description: description.join(' '),\n      sequence: sequence\n    };\n  });\n} // memoized\n\n\nvar FetchableSmallFasta = /*#__PURE__*/function () {\n  function FetchableSmallFasta(_ref) {\n    var fasta = _ref.fasta,\n        path = _ref.path;\n    (0, _classCallCheck2.default)(this, FetchableSmallFasta);\n\n    if (fasta) {\n      this.fasta = fasta;\n    } else if (path) {\n      this.fasta = new _localFile.default(path);\n    }\n\n    this.data = this.fasta.readFile().then(function (buffer) {\n      var text = buffer.toString('utf8');\n      return parseSmallFasta(text);\n    });\n  }\n\n  (0, _createClass2.default)(FetchableSmallFasta, [{\n    key: \"fetch\",\n    value: function () {\n      var _fetch = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(id, start, end) {\n        var data, entry, length;\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.data;\n\n              case 2:\n                data = _context.sent;\n                entry = data.find(function (iter) {\n                  return iter.id === id;\n                });\n                length = end - start;\n\n                if (entry) {\n                  _context.next = 7;\n                  break;\n                }\n\n                throw new Error(\"no sequence with id \".concat(id, \" exists\"));\n\n              case 7:\n                return _context.abrupt(\"return\", entry.sequence.substr(start, length));\n\n              case 8:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function fetch(_x, _x2, _x3) {\n        return _fetch.apply(this, arguments);\n      }\n\n      return fetch;\n    }()\n  }, {\n    key: \"getSequenceNames\",\n    value: function () {\n      var _getSequenceNames = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2() {\n        var data;\n        return _regenerator.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this.data;\n\n              case 2:\n                data = _context2.sent;\n                return _context2.abrupt(\"return\", data.map(function (entry) {\n                  return entry.id;\n                }));\n\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getSequenceNames() {\n        return _getSequenceNames.apply(this, arguments);\n      }\n\n      return getSequenceNames;\n    }()\n  }]);\n  return FetchableSmallFasta;\n}();\n\nexports.FetchableSmallFasta = FetchableSmallFasta;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _require = require('es6-promisify'),\n    promisify = _require.promisify;\n\nvar _require2 = require('browser-or-node'),\n    isNode = _require2.isNode; // don't load fs native module if running in the browser\n\n\nvar fsOpen;\nvar fsRead;\nvar fsFStat;\nvar fsReadFile;\n\nif (isNode) {\n  // eslint-disable-next-line global-require\n  var fs = require('fs');\n\n  fsOpen = fs && promisify(fs.open);\n  fsRead = fs && promisify(fs.read);\n  fsFStat = fs && promisify(fs.fstat);\n  fsReadFile = fs && promisify(fs.readFile);\n}\n\nvar LocalFile = /*#__PURE__*/function () {\n  function LocalFile(source) {\n    (0, _classCallCheck2.default)(this, LocalFile);\n    this.position = 0;\n    this.filename = source;\n    this.fd = fsOpen(this.filename, 'r');\n  }\n\n  (0, _createClass2.default)(LocalFile, [{\n    key: \"read\",\n    value: function () {\n      var _read = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(buffer) {\n        var offset,\n            length,\n            position,\n            readPosition,\n            ret,\n            _args = arguments;\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                offset = _args.length > 1 && _args[1] !== undefined ? _args[1] : 0;\n                length = _args.length > 2 ? _args[2] : undefined;\n                position = _args.length > 3 ? _args[3] : undefined;\n                readPosition = position;\n\n                if (readPosition === null) {\n                  readPosition = this.position;\n                  this.position += length;\n                }\n\n                _context.t0 = fsRead;\n                _context.next = 8;\n                return this.fd;\n\n              case 8:\n                _context.t1 = _context.sent;\n                _context.t2 = buffer;\n                _context.t3 = offset;\n                _context.t4 = length;\n                _context.t5 = position;\n                _context.next = 15;\n                return (0, _context.t0)(_context.t1, _context.t2, _context.t3, _context.t4, _context.t5);\n\n              case 15:\n                ret = _context.sent;\n\n                if (!((0, _typeof2.default)(ret) === 'object')) {\n                  _context.next = 18;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", ret.bytesRead);\n\n              case 18:\n                return _context.abrupt(\"return\", ret);\n\n              case 19:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function read(_x) {\n        return _read.apply(this, arguments);\n      }\n\n      return read;\n    }()\n  }, {\n    key: \"readFile\",\n    value: function () {\n      var _readFile = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2() {\n        return _regenerator.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                return _context2.abrupt(\"return\", fsReadFile(this.filename));\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function readFile() {\n        return _readFile.apply(this, arguments);\n      }\n\n      return readFile;\n    }()\n  }, {\n    key: \"stat\",\n    value: function () {\n      var _stat = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee3() {\n        return _regenerator.default.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (this._stat) {\n                  _context3.next = 8;\n                  break;\n                }\n\n                _context3.t0 = fsFStat;\n                _context3.next = 4;\n                return this.fd;\n\n              case 4:\n                _context3.t1 = _context3.sent;\n                _context3.next = 7;\n                return (0, _context3.t0)(_context3.t1);\n\n              case 7:\n                this._stat = _context3.sent;\n\n              case 8:\n                return _context3.abrupt(\"return\", this._stat);\n\n              case 9:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function stat() {\n        return _stat.apply(this, arguments);\n      }\n\n      return stat;\n    }()\n  }]);\n  return LocalFile;\n}();\n\nmodule.exports = LocalFile;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _localFile = _interopRequireDefault(require(\"./localFile\"));\n\nfunction _faiOffset(idx, pos) {\n  return idx.offset + idx.lineBytes * Math.floor(pos / idx.lineLength) + pos % idx.lineLength;\n}\n\nvar IndexedFasta = /*#__PURE__*/function () {\n  function IndexedFasta(_ref) {\n    var fasta = _ref.fasta,\n        fai = _ref.fai,\n        path = _ref.path,\n        faiPath = _ref.faiPath,\n        _ref$chunkSizeLimit = _ref.chunkSizeLimit,\n        chunkSizeLimit = _ref$chunkSizeLimit === void 0 ? 1000000 : _ref$chunkSizeLimit;\n    (0, _classCallCheck2.default)(this, IndexedFasta);\n\n    if (fasta) {\n      this.fasta = fasta;\n    } else if (path) {\n      this.fasta = new _localFile.default(path);\n    }\n\n    if (fai) {\n      this.fai = fai;\n    } else if (faiPath) {\n      this.fai = new _localFile.default(faiPath);\n    } else if (path) {\n      this.fai = new _localFile.default(\"\".concat(path, \".fai\"));\n    }\n\n    this.chunkSizeLimit = chunkSizeLimit;\n  }\n\n  (0, _createClass2.default)(IndexedFasta, [{\n    key: \"_getIndexes\",\n    value: function () {\n      var _getIndexes2 = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee() {\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (this.indexes) {\n                  _context.next = 4;\n                  break;\n                }\n\n                _context.next = 3;\n                return this._readFAI();\n\n              case 3:\n                this.indexes = _context.sent;\n\n              case 4:\n                return _context.abrupt(\"return\", this.indexes);\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function _getIndexes() {\n        return _getIndexes2.apply(this, arguments);\n      }\n\n      return _getIndexes;\n    }()\n  }, {\n    key: \"_readFAI\",\n    value: function () {\n      var _readFAI2 = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2() {\n        var indexByName, indexById, text, idCounter, currSeq;\n        return _regenerator.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                indexByName = {};\n                indexById = {};\n                _context2.next = 4;\n                return this.fai.readFile();\n\n              case 4:\n                text = _context2.sent;\n\n                if (text && text.length) {\n                  _context2.next = 7;\n                  break;\n                }\n\n                throw new Error('No data read from FASTA index (FAI) file');\n\n              case 7:\n                idCounter = 0;\n                text.toString('utf8').split(/\\r?\\n/).filter(function (line) {\n                  return /\\S/.test(line);\n                }).forEach(function (line) {\n                  var row = line.split('\\t');\n                  if (row[0] === '') return;\n\n                  if (!currSeq || currSeq.name !== row[0]) {\n                    currSeq = {\n                      name: row[0],\n                      id: idCounter\n                    };\n                    idCounter += 1;\n                  }\n\n                  var entry = {\n                    id: currSeq.id,\n                    name: row[0],\n                    length: +row[1],\n                    start: 0,\n                    end: +row[1],\n                    offset: +row[2],\n                    lineLength: +row[3],\n                    lineBytes: +row[4]\n                  };\n                  indexByName[entry.name] = entry;\n                  indexById[entry.id] = entry;\n                });\n                return _context2.abrupt(\"return\", {\n                  name: indexByName,\n                  id: indexById\n                });\n\n              case 10:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function _readFAI() {\n        return _readFAI2.apply(this, arguments);\n      }\n\n      return _readFAI;\n    }()\n    /**\n     * @returns {array[string]} array of string sequence\n     * names that are present in the index, in which the\n     * array index indicates the sequence ID, and the value\n     * is the sequence name\n     */\n\n  }, {\n    key: \"getSequenceNames\",\n    value: function () {\n      var _getSequenceNames = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee3() {\n        return _regenerator.default.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.t0 = Object;\n                _context3.next = 3;\n                return this._getIndexes();\n\n              case 3:\n                _context3.t1 = _context3.sent.name;\n                return _context3.abrupt(\"return\", _context3.t0.keys.call(_context3.t0, _context3.t1));\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function getSequenceNames() {\n        return _getSequenceNames.apply(this, arguments);\n      }\n\n      return getSequenceNames;\n    }()\n    /**\n     * @returns {array[string]} array of string sequence\n     * names that are present in the index, in which the\n     * array index indicates the sequence ID, and the value\n     * is the sequence name\n     */\n\n  }, {\n    key: \"getSequenceSizes\",\n    value: function () {\n      var _getSequenceSizes = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee4() {\n        var returnObject, idx, vals, i;\n        return _regenerator.default.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                returnObject = {};\n                _context4.next = 3;\n                return this._getIndexes();\n\n              case 3:\n                idx = _context4.sent;\n                vals = Object.values(idx.id);\n\n                for (i = 0; i < vals.length; i += 1) {\n                  returnObject[vals[i].name] = vals[i].length;\n                }\n\n                return _context4.abrupt(\"return\", returnObject);\n\n              case 7:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function getSequenceSizes() {\n        return _getSequenceSizes.apply(this, arguments);\n      }\n\n      return getSequenceSizes;\n    }()\n    /**\n     * @returns {array[string]} array of string sequence\n     * names that are present in the index, in which the\n     * array index indicates the sequence ID, and the value\n     * is the sequence name\n     */\n\n  }, {\n    key: \"getSequenceSize\",\n    value: function () {\n      var _getSequenceSize = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee5(seqName) {\n        var idx;\n        return _regenerator.default.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.next = 2;\n                return this._getIndexes();\n\n              case 2:\n                idx = _context5.sent;\n                return _context5.abrupt(\"return\", (idx.name[seqName] || {}).length);\n\n              case 4:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function getSequenceSize(_x) {\n        return _getSequenceSize.apply(this, arguments);\n      }\n\n      return getSequenceSize;\n    }()\n    /**\n     *\n     * @param {string} name\n     * @returns {Promise[boolean]} true if the file contains the given reference sequence name\n     */\n\n  }, {\n    key: \"hasReferenceSequence\",\n    value: function () {\n      var _hasReferenceSequence = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee6(name) {\n        return _regenerator.default.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _context6.next = 2;\n                return this._getIndexes();\n\n              case 2:\n                _context6.t0 = name;\n                return _context6.abrupt(\"return\", !!_context6.sent.name[_context6.t0]);\n\n              case 4:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function hasReferenceSequence(_x2) {\n        return _hasReferenceSequence.apply(this, arguments);\n      }\n\n      return hasReferenceSequence;\n    }()\n    /**\n     *\n     * @param {number} seqId\n     * @param {number} min\n     * @param {number} max\n     */\n\n  }, {\n    key: \"getResiduesById\",\n    value: function () {\n      var _getResiduesById = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee7(seqId, min, max) {\n        var indexEntry;\n        return _regenerator.default.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _context7.next = 2;\n                return this._getIndexes();\n\n              case 2:\n                _context7.t0 = seqId;\n                indexEntry = _context7.sent.id[_context7.t0];\n\n                if (indexEntry) {\n                  _context7.next = 6;\n                  break;\n                }\n\n                return _context7.abrupt(\"return\", undefined);\n\n              case 6:\n                return _context7.abrupt(\"return\", this._fetchFromIndexEntry(indexEntry, min, max));\n\n              case 7:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function getResiduesById(_x3, _x4, _x5) {\n        return _getResiduesById.apply(this, arguments);\n      }\n\n      return getResiduesById;\n    }()\n    /**\n     * @param {string} seqName\n     * @param {number} min\n     * @param {number} max\n     */\n\n  }, {\n    key: \"getResiduesByName\",\n    value: function () {\n      var _getResiduesByName = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee8(seqName, min, max) {\n        var indexEntry;\n        return _regenerator.default.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                _context8.next = 2;\n                return this._getIndexes();\n\n              case 2:\n                _context8.t0 = seqName;\n                indexEntry = _context8.sent.name[_context8.t0];\n\n                if (indexEntry) {\n                  _context8.next = 6;\n                  break;\n                }\n\n                return _context8.abrupt(\"return\", undefined);\n\n              case 6:\n                return _context8.abrupt(\"return\", this._fetchFromIndexEntry(indexEntry, min, max));\n\n              case 7:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function getResiduesByName(_x6, _x7, _x8) {\n        return _getResiduesByName.apply(this, arguments);\n      }\n\n      return getResiduesByName;\n    }()\n  }, {\n    key: \"getSequence\",\n    value: function () {\n      var _getSequence = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee9() {\n        var _args9 = arguments;\n        return _regenerator.default.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                return _context9.abrupt(\"return\", this.getResiduesByName.apply(this, _args9));\n\n              case 1:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n\n      function getSequence() {\n        return _getSequence.apply(this, arguments);\n      }\n\n      return getSequence;\n    }()\n  }, {\n    key: \"_fetchFromIndexEntry\",\n    value: function () {\n      var _fetchFromIndexEntry2 = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee10(indexEntry) {\n        var min,\n            max,\n            end,\n            position,\n            readlen,\n            residues,\n            _args10 = arguments;\n        return _regenerator.default.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                min = _args10.length > 1 && _args10[1] !== undefined ? _args10[1] : 0;\n                max = _args10.length > 2 ? _args10[2] : undefined;\n                end = max;\n\n                if (!(min < 0)) {\n                  _context10.next = 5;\n                  break;\n                }\n\n                throw new TypeError('regionStart cannot be less than 0');\n\n              case 5:\n                if (end === undefined || end > indexEntry.length) {\n                  end = indexEntry.length;\n                }\n\n                if (!(min >= end)) {\n                  _context10.next = 8;\n                  break;\n                }\n\n                return _context10.abrupt(\"return\", '');\n\n              case 8:\n                position = _faiOffset(indexEntry, min);\n                readlen = _faiOffset(indexEntry, end) - position;\n\n                if (!(readlen > this.chunkSizeLimit)) {\n                  _context10.next = 12;\n                  break;\n                }\n\n                throw new Error(\"data size of \".concat(readlen.toLocaleString(), \" bytes exceeded chunk size limit of \").concat(this.chunkSizeLimit.toLocaleString(), \" bytes\"));\n\n              case 12:\n                residues = Buffer.allocUnsafe(readlen);\n                _context10.next = 15;\n                return this.fasta.read(residues, 0, readlen, position);\n\n              case 15:\n                residues = residues.toString('utf8').replace(/\\s+/g, '');\n                return _context10.abrupt(\"return\", residues);\n\n              case 17:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function _fetchFromIndexEntry(_x9) {\n        return _fetchFromIndexEntry2.apply(this, arguments);\n      }\n\n      return _fetchFromIndexEntry;\n    }()\n  }]);\n  return IndexedFasta;\n}();\n\nmodule.exports = IndexedFasta;","import { IndexedFasta } from '@gmod/indexedfasta'\nimport {\n  BaseFeatureDataAdapter,\n  SequenceAdapter,\n} from '@jbrowse/core/data_adapters/BaseAdapter'\nimport { FileLocation, NoAssemblyRegion } from '@jbrowse/core/util/types'\nimport { openLocation } from '@jbrowse/core/util/io'\nimport { ObservableCreate } from '@jbrowse/core/util/rxjs'\nimport SimpleFeature, { Feature } from '@jbrowse/core/util/simpleFeature'\nimport { readConfObject } from '@jbrowse/core/configuration'\nimport { AnyConfigurationModel } from '@jbrowse/core/configuration/configurationSchema'\nimport AbortablePromiseCache from 'abortable-promise-cache'\nimport LRU from '@jbrowse/core/util/QuickLRU'\n\nexport default class extends BaseFeatureDataAdapter implements SequenceAdapter {\n  protected fasta: typeof IndexedFasta\n\n  private seqCache = new AbortablePromiseCache({\n    cache: new LRU({ maxSize: 200 }),\n    fill: async (\n      args: { refName: string; start: number; end: number },\n      // abortSignal?: AbortSignal,\n    ) => {\n      const { refName, start, end } = args\n      return this.fasta.getSequence(refName, start, end)\n    },\n  })\n\n  public constructor(config: AnyConfigurationModel) {\n    super(config)\n    const fastaLocation = readConfObject(config, 'fastaLocation')\n    const faiLocation = readConfObject(config, 'faiLocation')\n    if (!fastaLocation) {\n      throw new Error('must provide fastaLocation')\n    }\n    if (!faiLocation) {\n      throw new Error('must provide faiLocation')\n    }\n    const fastaOpts = {\n      fasta: openLocation(fastaLocation as FileLocation),\n      fai: openLocation(faiLocation as FileLocation),\n    }\n\n    this.fasta = new IndexedFasta(fastaOpts)\n  }\n\n  public getRefNames() {\n    return this.fasta.getSequenceNames()\n  }\n\n  public async getRegions(): Promise<NoAssemblyRegion[]> {\n    const seqSizes = await this.fasta.getSequenceSizes()\n    return Object.keys(seqSizes).map(\n      (refName: string): NoAssemblyRegion => ({\n        refName,\n        start: 0,\n        end: seqSizes[refName],\n      }),\n    )\n  }\n\n  /**\n   * Fetch features for a certain region\n   * @param param -\n   * @returns Observable of Feature objects in the region\n   */\n  public getFeatures({ refName, start, end }: NoAssemblyRegion) {\n    return ObservableCreate<Feature>(async observer => {\n      const size = await this.fasta.getSequenceSize(refName)\n      const regionEnd = size !== undefined ? Math.min(size, end) : end\n      const chunks = []\n      const chunkSize = 128000\n\n      const s = start - (start % chunkSize)\n      const e = end + (chunkSize - (end % chunkSize))\n      for (let chunkStart = s; chunkStart < e; chunkStart += chunkSize) {\n        const r = {\n          refName,\n          start: chunkStart,\n          end: chunkStart + chunkSize,\n        }\n        chunks.push(this.seqCache.get(JSON.stringify(r), r))\n      }\n      const seq = (await Promise.all(chunks))\n        .join('')\n        .slice(start - s)\n        .slice(0, end - start)\n      if (seq) {\n        observer.next(\n          new SimpleFeature({\n            id: `${refName} ${start}-${regionEnd}`,\n            data: { refName, start, end: regionEnd, seq },\n          }),\n        )\n      }\n      observer.complete()\n    })\n  }\n\n  /**\n   * called to provide a hint that data tied to a certain region\n   * will not be needed for the forseeable future and can be purged\n   * from caches, etc\n   */\n  public freeResources(/* { region } */): void {}\n}\n","var arrayWithHoles = require(\"./arrayWithHoles.js\");\n\nvar iterableToArray = require(\"./iterableToArray.js\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\n\nvar nonIterableRest = require(\"./nonIterableRest.js\");\n\nfunction _toArray(arr) {\n  return arrayWithHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableRest();\n}\n\nmodule.exports = _toArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n/* global window self */\n\nvar isBrowser = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n\n/* eslint-disable no-restricted-globals */\nvar isWebWorker = (typeof self === 'undefined' ? 'undefined' : _typeof(self)) === 'object' && self.constructor && self.constructor.name === 'DedicatedWorkerGlobalScope';\n/* eslint-enable no-restricted-globals */\n\nvar isNode = typeof process !== 'undefined' && process.versions != null && process.versions.node != null;\n\n/**\n * @see https://github.com/jsdom/jsdom/releases/tag/12.0.0\n * @see https://github.com/jsdom/jsdom/issues/1537\n */\n/* eslint-disable no-undef */\nvar isJsDom = function isJsDom() {\n  return typeof window !== 'undefined' && window.name === 'nodejs' || navigator.userAgent.includes('Node.js') || navigator.userAgent.includes('jsdom');\n};\n\nexports.isBrowser = isBrowser;\nexports.isWebWorker = isWebWorker;\nexports.isNode = isNode;\nexports.isJsDom = isJsDom;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _bgzfFilehandle = require(\"@gmod/bgzf-filehandle\");\n\nvar _indexedFasta = _interopRequireDefault(require(\"./indexedFasta\"));\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar BgzipIndexedFasta = /*#__PURE__*/function (_IndexedFasta) {\n  (0, _inherits2.default)(BgzipIndexedFasta, _IndexedFasta);\n\n  var _super = _createSuper(BgzipIndexedFasta);\n\n  function BgzipIndexedFasta(_ref) {\n    var _this;\n\n    var fasta = _ref.fasta,\n        path = _ref.path,\n        fai = _ref.fai,\n        faiPath = _ref.faiPath,\n        gzi = _ref.gzi,\n        gziPath = _ref.gziPath,\n        chunkSizeLimit = _ref.chunkSizeLimit;\n    (0, _classCallCheck2.default)(this, BgzipIndexedFasta);\n    _this = _super.call(this, {\n      fasta: fasta,\n      path: path,\n      fai: fai,\n      faiPath: faiPath,\n      chunkSizeLimit: chunkSizeLimit\n    });\n\n    if (fasta && gzi) {\n      _this.fasta = new _bgzfFilehandle.BgzfFilehandle({\n        filehandle: fasta,\n        gziFilehandle: gzi\n      });\n    } else if (path && gziPath) {\n      _this.fasta = new _bgzfFilehandle.BgzfFilehandle({\n        path: path,\n        gziPath: gziPath\n      });\n    }\n\n    return _this;\n  }\n\n  return BgzipIndexedFasta;\n}(_indexedFasta.default);\n\nmodule.exports = BgzipIndexedFasta;"],"sourceRoot":""}